<!DOCTYPE html><html class="default"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="IE=edge"/><title>tapjaw-importer</title><meta name="description" content="Documentation for tapjaw-importer"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="assets/style.css"/><link rel="stylesheet" href="assets/highlight.css"/><script async src="assets/search.js" id="search-script"></script></head><body><script>document.body.classList.add(localStorage.getItem("tsd-theme") || "os")</script><header><div class="tsd-page-toolbar"><div class="container"><div class="table-wrap"><div class="table-cell" id="tsd-search" data-base="."><div class="field"><label for="tsd-search-field" class="tsd-widget search no-caption">Search</label><input type="text" id="tsd-search-field"/></div><ul class="results"><li class="state loading">Preparing search index...</li><li class="state failure">The search index is not available</li></ul><a href="index.html" class="title">tapjaw-importer</a></div><div class="table-cell" id="tsd-widgets"><div id="tsd-filter"><a href="#" class="tsd-widget options no-caption" data-toggle="options">Options</a><div class="tsd-filter-group"><div class="tsd-select" id="tsd-filter-visibility"><span class="tsd-select-label">All</span><ul class="tsd-select-list"><li data-value="public">Public</li><li data-value="protected">Public/Protected</li><li data-value="private" class="selected">All</li></ul></div> <input type="checkbox" id="tsd-filter-inherited" checked/><label class="tsd-widget" for="tsd-filter-inherited">Inherited</label><input type="checkbox" id="tsd-filter-externals" checked/><label class="tsd-widget" for="tsd-filter-externals">Externals</label></div></div><a href="#" class="tsd-widget menu no-caption" data-toggle="menu">Menu</a></div></div></div></div><div class="tsd-page-title"><div class="container"><h1>tapjaw-importer</h1></div></div></header><div class="container container-main"><div class="row"><div class="col-8 col-content"><div class="tsd-panel tsd-typography">
<a href="#tapjaw-importer---v200" id="tapjaw-importer---v200" style="color: inherit; text-decoration: none;">
  <h1>Tapjaw Importer - v2.0.0</h1>
</a>
<p><img src="./resources/diagram.png" alt="diagram" title="Tapjaw Diagram"></p>
<p>Create a stream of payload messages to STDOUT from any API.</p>
<!-- toc -->
<ul>
<li><a href="#tapjaw-importer---v200">Tapjaw Importer - v2.0.0</a></li>
<li><a href="#description">Description</a></li>
<li><a href="#history">History</a></li>
<li><a href="#why-use-tapjaw-importer">Why use Tapjaw Importer?</a></li>
<li><a href="#dependancies">Dependancies</a></li>
<li><a href="#setup-a-new-project">Setup a new project</a></li>
<li><a href="#components">Components</a><ul>
<li><a href="#commands">Commands</a></li>
<li><a href="#adapters">Adapters</a></li>
<li><a href="#configs">Configs</a></li>
<li><a href="#connectors">Connectors</a></li>
<li><a href="#contracts">Contracts</a><ul>
<li><a href="#tapjawmessage">TapjawMessage</a></li>
</ul>
</li>
<li><a href="#iterators">Iterators</a></li>
</ul>
</li>
<li><a href="#examples--tutorial">Examples &amp; Tutorial</a></li>
<li><a href="#changelog">Changelog</a><ul>
<li><a href="#v200">v2.0.0</a></li>
<li><a href="#v120-no-longer-supported">v1.2.0 <em>(no longer supported)</em></a></li>
<li><a href="#previous-versions">Previous versions</a><!-- tocstop --></li>
</ul>
</li>
</ul>

<a href="#description" id="description" style="color: inherit; text-decoration: none;">
  <h1>Description</h1>
</a>
<p>Tapjaw Importer is a Typescript JSON-based utility framework purposefully designed to simplify the development of commands that chain together to consolidate data for persistence or further processing in the cloud or on your infrastructure.</p>
<p>The chained commands communicate with JSON over an STDIO stream using a pre-defined class called a <code>TapjawMessage</code>, containing some default metadata and payload properties, allowing for easy extending from the <code>TapjawMessage</code> Class based on the business rules of implementation.</p>
<p>The <code>TapjawMessage</code> schema enables the creation of a standardised streaming paradigm with JSON delimited by newlines, using the Unix pipe syntax, e.g.:-</p>
<pre><code class="language-bash"><span class="hl-0">$ bin/run apis my-network | bin/run filters remove-duplicates | bin/run stores s3 s3://my-bucket</span>
</code></pre>
<p>In practice, you would use one API command in conjunction with multiple filter commands, finishing with a store command to persist the result in an external location. If you wish to output to various store commands, you can employ a Tools command to boot up multiple child processes and fan out to several store commands. Please refer to the example below for a pseudo-example:</p>
<pre><code class="language-bash"><span class="hl-0">$ bin/run apis my-network | bin/run filters remove-duplicates | bin/run filters clean | bin/run tools fan </span><span class="hl-1">&quot;stores s3 s3://my-bucket&quot;</span><span class="hl-0"> </span><span class="hl-1">&quot;stores sqs sqs://sqs-server/my-queue&quot;</span>
</code></pre>
<p>The project provides several additional useful features to decrease the complexity of:</p>
<ul>
<li>Access HTTP/API endpoints with Connectors (<code>TapjawConnector</code> &amp; <code>TapjawHttpConnector</code>).<ul>
<li>Security implementations for Bearer, Basic and OAuth authentication.</li>
</ul>
</li>
<li>Iterate seamlessly over multiple pages of response data using Adapters (<code>TapjawAdapter</code>).</li>
<li>Parser tools to convert XML or CSV to JSON (<code>xmlToJson</code> &amp; <code>csvToJson</code>).</li>
<li>Strong focus on Typescript data typing, employing contracted interfaces throughout the framework.</li>
<li>Rate limiting of messages getting pushed through a stream from the API command.</li>
<li>Each command type is has a base class designed for its purpose, meaning you only need to write a minimal amount of code.</li>
<li>Date helper functions, providing a common toolkit that we&#39;ve had to use in previous projects (using Luxon).</li>
<li>A quick and simple .env configuration loading strategy (<code>DotEnvConfig</code>, <em>ref: <code>TapjawMessageConfig</code> for implementation</em>).</li>
<li>Base <code>TapjawLogger</code> interface to allow easy implementation of your logging library. The project includes two basic implementations, <code>ConsoleLogger</code> and <code>NullLogger</code>, which <code>NullLogger</code> is generally used in testing.</li>
</ul>

<a href="#history" id="history" style="color: inherit; text-decoration: none;">
  <h1>History</h1>
</a>
<p>Tapjaw Importer started life in 2019 due to a requirement of needing to import data from across dozens of APIs into a consistent internal schema,
each API has unique data schemas, various security infrastructures, request/response strategies and general differences in approach.</p>
<p>Tapjaw Importer&#39;s inspiration comes from the singer.io approach, which provides many API taps and targets. However, as an Affiliate Marketing company, we couldn&#39;t rely on singer.io to have all the APIs we needed. Instead, we created this framework that provides a more diverse approach to extracting data and doing something useful with it.</p>
<p>Tapjaw Importer provides a more abstract approach than singer.io by employing customisable API, filter, store and tool commands.</p>
<p>You as a developer can chain together as many commands as required as your business model sees fit in accomplishing the consolidation of data. You, as the developer, do not need to concern yourself with how data traverses through the commands.</p>
<p>We&#39;ve successfully written and deployed four separate internal projects into production using this framework, allowing us to experience such a process&#39;s complexities. We&#39;ve attempted to provide the necessary components to quickly set up your commands and data stream through this process.</p>

<a href="#why-use-tapjaw-importer" id="why-use-tapjaw-importer" style="color: inherit; text-decoration: none;">
  <h1>Why use Tapjaw Importer?</h1>
</a>
<ol>
<li>You use node.js with Typescript or Javascript.</li>
<li>Require a framework which allows you to quickly create API commands that streams each record to a STDOUT buffer.</li>
<li>Be able to quickly mix and match commands for your business purposes.</li>
<li>Slots in easily into existing system infrastructure.</li>
<li>The ability to create a custom toolkit of bespoke scalable commands.</li>
<li>Easy to implement data consolidation for cloud-based serverless projects.</li>
<li>An simple interface for creating streams of data between commands.</li>
</ol>

<a href="#dependancies" id="dependancies" style="color: inherit; text-decoration: none;">
  <h1>Dependancies</h1>
</a>
<ul>
<li>Node JS v16</li>
<li>Commander.js</li>
<li>reflect-metadata</li>
<li>Typescript 4</li>
<li>Unix based operating system (it might work in Windows, but no certainty can be provided)</li>
</ul>

<a href="#setup-a-new-project" id="setup-a-new-project" style="color: inherit; text-decoration: none;">
  <h1>Setup a new project</h1>
</a>
<p>Firstly, execute <code>cd</code> to your workspace or development directory.</p>
<pre><code class="language-bash"><span class="hl-0">~/workspace $&gt; git clone </span><span class="hl-1">&quot;https://github.com/digidip/tapjaw-example.git#semver^2&quot;</span><span class="hl-0"> my-project</span>
</code></pre>
<blockquote>
<p><strong>Caution</strong>: Please make sure you&#39;re using Node version 16. You may use <a href="https://github.com/nvm-sh/nvm"><code>nvm</code></a> for managing your node versions.</p>
</blockquote>
<p>Now install all the frameworks dependencies. If you&#39;re not using node 16, you will get encounter an error.</p>
<pre><code class="language-bash"><span class="hl-0">~/workspace/my-project $&gt; yarn install</span>
</code></pre>
<p>Build the project with:</p>
<pre><code class="language-bash"><span class="hl-0">~/workspace/my-project $&gt; yarn tsc</span>
</code></pre>
<p>To validate the project, issue the following command:</p>
<pre><code class="language-bash"><span class="hl-0">~/workspace/my-project $&gt; bin/run</span>
</code></pre>
<p>You should see a similar output:</p>
<pre><code class="language-bash"><span class="hl-0">Usage: run [options] [command]</span><br/><br/><span class="hl-0">Options:</span><br/><span class="hl-0">  -V, --version     output the version number</span><br/><span class="hl-0">  -h, --help        display </span><span class="hl-2">help</span><span class="hl-0"> </span><span class="hl-3">for</span><span class="hl-0"> </span><span class="hl-2">command</span><br/><br/><span class="hl-0">Commands:</span><br/><span class="hl-0">  apis &lt;api&gt;        Execute an API </span><span class="hl-2">command</span><br/><span class="hl-0">  filters &lt;filter&gt;  Execute a filter </span><span class="hl-2">command</span><br/><span class="hl-0">  stores &lt;store&gt;    Execute a store </span><span class="hl-2">command</span><br/><span class="hl-0">  tools &lt;tool&gt;      Execute a tool </span><span class="hl-2">command</span><br/><span class="hl-0">  </span><span class="hl-2">help</span><span class="hl-0"> [command]    display </span><span class="hl-2">help</span><span class="hl-0"> </span><span class="hl-3">for</span><span class="hl-0"> </span><span class="hl-2">command</span>
</code></pre>
<p>You are now ready to start working on your project. Refer to the <code>digidip/tapjaw-example</code>&#39;s <a href="https://github.com/digidip/tapjaw-example/blob/v2.0.0/README.md">README.md</a> for a tutorial on how to get get started.</p>

<a href="#components" id="components" style="color: inherit; text-decoration: none;">
  <h1>Components</h1>
</a>
<p>An overview of each component is available in Tapjaw Importer, focusing on each element with corresponding documentation in how to implement, extend and use correctly.</p>

<a href="#commands" id="commands" style="color: inherit; text-decoration: none;">
  <h2>Commands</h2>
</a>
<p>Commands are the defined set of entrypoints in a project, commands consist of four distict types in Tapjaw Importer, each with a specific domain. Read the documentation links below to get an overview on how commands are configured and which command is used, for what purpose.</p>
<ul>
<li><a href="docs/commands.md">Commands overivew</a> - Overview of what is necessary to create a command.</li>
<li><a href="docs/api-commands.md">API commands</a> - Pull data using connectors &amp; adapters, converting each record into a <code>TapjawMessage</code> and write to the stdout stream.</li>
<li><a href="docs/filter-commands.md">Filter commands</a> - Filter out stdin stream messages or forward messages to the stdout stream based on rules.</li>
<li><a href="docs/store-commands.md">Store commands</a> - Persist incoming stdin messages to an external service, such as DBMS, s3 or a queue.</li>
<li><a href="docs/tool-commands.md">Tool commands</a> - Additional commands which do not fit within the specification of the previous three categories, for example mutating a message.</li>
</ul>

<a href="#adapters" id="adapters" style="color: inherit; text-decoration: none;">
  <h2>Adapters</h2>
</a>
<p>Adapters are the agnostic link between an API command and a connector. The adapter implements the business logic on managing the responses from the connector and yields a <code>TapjawMessage</code> to the command to then be written to an output buffer.</p>
<p>Please refer to <a href="./docs/adapters.md">Adapter documentation</a>.</p>

<a href="#configs" id="configs" style="color: inherit; text-decoration: none;">
  <h2>Configs</h2>
</a>
<p>By default Tapjaw Importer will use the <code>.env</code> (<a href="https://github.com/motdotla/dotenv">dotenv</a>) approach towards configuration. Dotenv allows for creating a <code>.env</code> file in your project directory or the possibility to inject environment variables with an alternative method that your project can still read without a <code>.env</code> file. Ideally, you would use the <code>.env</code> approach during development and then use an external setter of environmental variables in production.</p>
<p>For more details please refer to <a href="docs/configurations.md">Configurations documentation</a>.</p>

<a href="#connectors" id="connectors" style="color: inherit; text-decoration: none;">
  <h2>Connectors</h2>
</a>
<p>The purpose of a connector is to allow an adapter to use different external services. For example, some third party APIs will have a RESTful or SOAP API. The <em>Connector Pattern</em> will enable us to create two implementations with identical method signatures for the adapter to use. The developer then chooses to switch between either connector and expect the adapter to operate seamlessly regardless of whichever connector is in use.</p>
<p>Please refer to <a href="./docs/connectors.md">Connectors documentation</a>.</p>

<a href="#contracts" id="contracts" style="color: inherit; text-decoration: none;">
  <h2>Contracts</h2>
</a>
<p>The interfaces for Connectors, Adapters, Commands and Messages exist by default, and you can also extend from this directory for specifying types and interfaces for your project.</p>
<p>Please refer to <a href="./docs/contracts.md">Contracts documentation</a>.</p>

<a href="#tapjawmessage" id="tapjawmessage" style="color: inherit; text-decoration: none;">
  <h3>TapjawMessage</h3>
</a>
<p>Each message (<code>TapjawMessage</code>) is composed of a payload without structural constraints, import date, identifier and a <em>sha256</em> signature generated from the Payload.</p>

<a href="#iterators" id="iterators" style="color: inherit; text-decoration: none;">
  <h2>Iterators</h2>
</a>
<p>Tapjaw Iterators designed purpose is to iterate over the yielded messages provided by an Adapter and output each to an external interface. Tapjaw Importer tends to write to the <a href="https://en.wikipedia.org/wiki/Standard_streams">standard output</a> (stdout) stream. You can override by extending the <code>OutputIterator</code> class or the <code>TapjawIterator</code> interface.</p>
<p>Please refer to <a href="./docs/iterators.md">Iterators documentation</a>.</p>
<p>Tapjaw Importer writes the STDOUT buffer due to the Unix feature of chaining of commands. In Unix derived systems, &quot;piping&quot; can be accomplished with the following example:</p>
<pre><code class="language-bash"><span class="hl-0">$ cat /etc/hosts | grep localhost</span><br/><span class="hl-0">127.0.0.1       localhost digidip.local</span><br/><span class="hl-0">::1             localhost</span>
</code></pre>
<p>Tapjaw Importer provides two pre-implemented Iterators. Both are detailed before:-</p>

<a href="#examples-amp-tutorial" id="examples-amp-tutorial" style="color: inherit; text-decoration: none;">
  <h1>Examples &amp; Tutorial</h1>
</a>
<p>Reference the <a href="https://github.com/digidip/tapjaw-example/blob/v2.0.0">Tapjaw Example v2.0</a> for an example on implementing a project.</p>

<a href="#changelog" id="changelog" style="color: inherit; text-decoration: none;">
  <h1>Changelog</h1>
</a>
<p>The project employs the <a href="https://semver.org/">semver</a> specification on versioning.</p>

<a href="#v200" id="v200" style="color: inherit; text-decoration: none;">
  <h2>v2.0.0</h2>
</a>
<ul>
<li>Add date helper functions.</li>
<li>Add standard Connector and Adapter errors.</li>
<li>Typeguards.</li>
<li>Update dependencies, ESLint and prettier.</li>
<li>Add command contracts for APIs, Filters, Stores and Tools.</li>
<li>Fix legacy typescript issues.</li>
<li>Standardise the JSON parsing of <code>TapjawMessage</code>.</li>
<li>Abstract streaming management in filter/store command contracts.</li>
<li>Documentation.</li>
<li>Implement the npm package publishing (#TODO).</li>
<li>Implements reflect-metadata, added <code>@TapjawMetadata.Command.*</code> and <code>@TapjawMetadata.Connector.*</code> decorator methods for configuring commands and connectors, <a href="docs/commands.md#tapjaw-metadata-command-decorators">read more</a>.</li>
<li>Renamed AdapterError to TapjawAdapterError (breaking change).</li>
</ul>

<a href="#v120-no-longer-supported" id="v120-no-longer-supported" style="color: inherit; text-decoration: none;">
  <h2>v1.2.0 <em>(no longer supported)</em></h2>
</a>
<ul>
<li>Convert from OCLIF to Commander.js.</li>
<li>Upgrade to Typescript 4.</li>
</ul>

<a href="#previous-versions" id="previous-versions" style="color: inherit; text-decoration: none;">
  <h2>Previous versions</h2>
</a>
<ul>
<li>The project was still in its infancy.</li>
</ul>
</div></div><div class="col-4 col-menu menu-sticky-wrap menu-highlight"><nav class="tsd-navigation primary"><ul><li class="current"><a href="modules.html">Exports</a></li><li class=" tsd-kind-namespace"><a href="modules/_internal_.html">&lt;internal&gt;</a></li><li class=" tsd-kind-namespace"><a href="modules/TapjawAuthenticator.html">Tapjaw<wbr/>Authenticator</a></li><li class=" tsd-kind-namespace"><a href="modules/TapjawCommand.html">Tapjaw<wbr/>Command</a></li><li class=" tsd-kind-namespace"><a href="modules/TapjawConfig.html">Tapjaw<wbr/>Config</a></li><li class=" tsd-kind-namespace"><a href="modules/TapjawConnector.html">Tapjaw<wbr/>Connector</a></li><li class=" tsd-kind-namespace"><a href="modules/TapjawContract.html">Tapjaw<wbr/>Contract</a></li><li class=" tsd-kind-namespace"><a href="modules/TapjawDate.html">Tapjaw<wbr/>Date</a></li><li class=" tsd-kind-namespace"><a href="modules/TapjawError.html">Tapjaw<wbr/>Error</a></li><li class=" tsd-kind-namespace"><a href="modules/TapjawIterator.html">Tapjaw<wbr/>Iterator</a></li><li class=" tsd-kind-namespace"><a href="modules/TapjawMessage.html">Tapjaw<wbr/>Message</a></li><li class=" tsd-kind-namespace"><a href="modules/TapjawMetadata.html">Tapjaw<wbr/>Metadata</a></li><li class=" tsd-kind-namespace"><a href="modules/TapjawParser.html">Tapjaw<wbr/>Parser</a></li><li class=" tsd-kind-namespace"><a href="modules/TapjawTypeguard.html">Tapjaw<wbr/>Typeguard</a></li></ul></nav><nav class="tsd-navigation secondary menu-sticky"><ul></ul></nav></div></div></div><footer class="with-border-bottom"><div class="container"><h2>Settings</h2><p>Theme <select id="theme"><option value="os">OS</option><option value="light">Light</option><option value="dark">Dark</option></select></p></div></footer><div class="container tsd-generator"><p>Generated using <a href="https://typedoc.org/" target="_blank">TypeDoc</a></p></div><div class="overlay"></div><script src="assets/main.js"></script></body></html>